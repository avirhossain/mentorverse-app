{
  "entities": {
    "Mentee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Mentee",
      "type": "object",
      "description": "Represents a mentee in the MentorVerse application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the mentee."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the mentee."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the mentee."
        },
        "email": {
          "type": "string",
          "description": "Email address of the mentee.",
          "format": "email"
        },
        "mentorshipGoal": {
          "type": "string",
          "description": "The mentee's stated goal for the mentorship."
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "mentorshipGoal"
      ]
    },
    "Mentor": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Mentor",
      "type": "object",
      "description": "Represents a mentor in the MentorVerse application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the mentor."
        },
        "firstName": {
          "type": "string",
          "description": "First name of the mentor."
        },
        "lastName": {
          "type": "string",
          "description": "Last name of the mentor."
        },
        "email": {
          "type": "string",
          "description": "Email address of the mentor.",
          "format": "email"
        },
        "profile": {
          "type": "string",
          "description": "Mentor profile information"
        }
      },
      "required": [
        "id",
        "firstName",
        "lastName",
        "email",
        "profile"
      ]
    },
    "Session": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Session",
      "type": "object",
      "description": "Represents a mentorship session.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the session."
        },
        "mentorId": {
          "type": "string",
          "description": "Reference to Mentor. (Relationship: Mentor 1:N Session)"
        },
        "menteeId": {
          "type": "string",
          "description": "Reference to Mentee. (Relationship: Mentee 1:N Session)"
        },
        "startTime": {
          "type": "string",
          "description": "Start time of the session.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "End time of the session.",
          "format": "date-time"
        },
        "cost": {
          "type": "number",
          "description": "Cost of the session."
        }
      },
      "required": [
        "id",
        "mentorId",
        "menteeId",
        "startTime",
        "endTime",
        "cost"
      ]
    },
    "Recommendation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Recommendation",
      "type": "object",
      "description": "Represents a mentor recommendation for a mentee.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the recommendation."
        },
        "menteeId": {
          "type": "string",
          "description": "Reference to Mentee. (Relationship: Mentee 1:N Recommendation)"
        },
        "mentorId": {
          "type": "string",
          "description": "Reference to Mentor. (Relationship: Mentor 1:N Recommendation)"
        },
        "reason": {
          "type": "string",
          "description": "Reason for the recommendation."
        }
      },
      "required": [
        "id",
        "menteeId",
        "mentorId",
        "reason"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "Mentee",
          "schema": {
            "$ref": "#/backend/entities/Mentee"
          },
          "description": "Stores mentee profile data. Path-based ownership ensures only the authenticated user (mentee) can access their own profile.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Auth UID of the mentee."
            }
          ]
        }
      },
      {
        "path": "/mentors/{mentorId}",
        "definition": {
          "entityName": "Mentor",
          "schema": {
            "$ref": "#/backend/entities/Mentor"
          },
          "description": "Stores mentor profile data. Accessible by admins.",
          "params": [
            {
              "name": "mentorId",
              "description": "The unique identifier for the mentor."
            }
          ]
        }
      },
      {
        "path": "/sessions/{sessionId}",
        "definition": {
          "entityName": "Session",
          "schema": {
            "$ref": "#/backend/entities/Session"
          },
          "description": "Stores mentorship session data. Includes denormalized 'menteeId' for authorization independence.  Admins have full access; mentees can only access sessions where 'menteeId' matches their UID.",
          "params": [
            {
              "name": "sessionId",
              "description": "The unique identifier for the session."
            }
          ]
        }
      },
      {
        "path": "/recommendations/{recommendationId}",
        "definition": {
          "entityName": "Recommendation",
          "schema": {
            "$ref": "#/backend/entities/Recommendation"
          },
          "description": "Stores mentor recommendations for mentees. Includes denormalized 'menteeId' for authorization independence. Admins have full access; mentees can only access recommendations where 'menteeId' matches their UID.",
          "params": [
            {
              "name": "recommendationId",
              "description": "The unique identifier for the recommendation."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{userId}",
        "definition": {
          "entityName": "admin",
          "schema": {
            "$ref": "#/backend/entities/Mentee"
          },
          "description": "Used for determining admin access. Existence of a document at this path grants admin privileges.  Content is irrelevant.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Auth UID of the admin user."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore structure is designed to support the MentorVerse application, focusing on security, scalability, and ease of maintenance. It leverages denormalization for authorization independence, structural segregation for simplified security rules, and consistent access modeling.  \n\n**Authorization Independence:**  The structure avoids `get()` calls in security rules by denormalizing authorization data. The primary method for this is storing the menteeId in each session and recommendation to ensure the mentee can only access sessions and recommendations related to them. This applies to the `/sessions` and `/recommendations` collections. Additionally, roles are managed via document existence in `/roles_admin/{uid}`.\n\n**Structural Segregation:** Data with different access requirements are stored in separate collections. Mentees have path-based ownership of their profile data under `/users/{userId}`. This keeps mentee profile data separate from mentor data and admin-managed data.\n\n**Access Modeling:**  Path-based ownership is used for mentee profiles. Collaborative data access for sessions and recommendations is managed using the menteeId within the document.  Admins are granted full access via document existence in the `/roles_admin/{uid}` collection.\n\n**QAPs (Rules are not Filters):** The structure supports secure `list` operations.  Mentees can list only their sessions and recommendations because the security rules will verify the `menteeId` matches the requesting user's ID.  Admin access is granted at the collection level (e.g., can list all mentors), while mentee access is constrained by the mentee's user ID."
  }
}